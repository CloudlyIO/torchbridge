============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
metadata: {'Python': '3.10.12', 'Platform': 'Linux-6.8.0-1045-gcp-x86_64-with-glibc2.35', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'metadata': '3.1.1', 'json-report': '1.5.0'}}
rootdir: /home/shahrahman
plugins: metadata-3.1.1, json-report-1.5.0
collecting ... collected 66 items

tests/test_nvidia_backend.py::TestNVIDIABackend::test_backend_creation_no_cuda PASSED [  1%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_backend_creation_with_cuda PASSED [  3%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_prepare_model_no_cuda PASSED [  4%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_h100_detection PASSED [  6%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_fp8_support_detection PASSED [  7%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_get_device_info PASSED [  9%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_get_memory_stats PASSED [ 10%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_optimize_for_tensor_cores PASSED [ 12%]
tests/test_nvidia_backend.py::TestNVIDIABackend::test_backend_with_custom_config PASSED [ 13%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_optimizer_creation PASSED [ 15%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_conservative_optimization PASSED [ 16%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_balanced_optimization PASSED [ 18%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_aggressive_optimization PASSED [ 19%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_optimize_for_inference PASSED [ 21%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_optimize_for_training PASSED [ 22%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_get_optimization_recommendations PASSED [ 24%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_optimization_with_sample_inputs PASSED [ 25%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_mixed_precision_enablement PASSED [ 27%]
tests/test_nvidia_backend.py::TestNVIDIAOptimizer::test_optimization_warnings PASSED [ 28%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_fp8_compiler_creation PASSED [ 30%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_fp8_support_hopper PASSED [ 31%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_fp8_support_ampere PASSED [ 33%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_prepare_for_fp8_inference PASSED [ 34%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_prepare_for_fp8_training PASSED [ 36%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_fp8_stats PASSED     [ 37%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_estimate_speedup_hopper PASSED [ 39%]
tests/test_nvidia_backend.py::TestFP8Compiler::test_compile_with_fp8 PASSED [ 40%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_memory_manager_creation PASSED [ 42%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_allocate_tensor PASSED [ 43%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_allocate_with_pool PASSED [ 45%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_optimize_tensor_layout PASSED [ 46%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_get_memory_stats PASSED [ 48%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_optimize_model_memory PASSED [ 50%]
tests/test_nvidia_backend.py::TestNVIDIAMemoryManager::test_clear_pool PASSED [ 51%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_creation PASSED [ 53%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_forward PASSED [ 54%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_with_mask PASSED [ 56%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_return_weights PASSED [ 57%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_create_flash_attention_3 PASSED [ 59%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_dropout PASSED [ 60%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_invalid_dimensions PASSED [ 62%]
tests/test_nvidia_backend.py::TestFlashAttention3::test_flash_attention_standard_fallback PASSED [ 63%]
tests/test_nvidia_backend.py::TestCUDAUtilities::test_cuda_device_manager_no_cuda PASSED [ 65%]
tests/test_nvidia_backend.py::TestCUDAUtilities::test_cuda_device_manager_with_cuda PASSED [ 66%]
tests/test_nvidia_backend.py::TestCUDAUtilities::test_cuda_optimizations PASSED [ 68%]
tests/test_nvidia_backend.py::TestCUDAUtilities::test_get_cuda_env_info PASSED [ 69%]
tests/test_nvidia_backend.py::TestCUDAUtilities::test_create_cuda_integration PASSED [ 71%]
tests/test_nvidia_backend.py::TestNVIDIAIntegration::test_full_optimization_pipeline PASSED [ 72%]
tests/test_nvidia_backend.py::TestNVIDIAIntegration::test_backend_with_memory_manager PASSED [ 74%]
tests/test_nvidia_backend.py::TestNVIDIAIntegration::test_end_to_end_inference_optimization PASSED [ 75%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_allocation_error_handling PASSED [ 77%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_cuda_not_available_graceful_fallback PASSED [ 78%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_check_when_cuda_unavailable PASSED [ 80%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_oom_protection_with_insufficient_memory PASSED [ 81%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_invalid_model_input PASSED [ 83%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_flash_attention_causal_parameter PASSED [ 84%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_fp8_compiler_metadata_only_warning PASSED [ 86%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_allocation_with_cleanup PASSED [ 87%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_optimizer_with_invalid_optimization_level PASSED [ 89%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_stats_tensor_size_estimation PASSED [ 90%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_unsupported_compute_capability PASSED [ 92%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_flash_attention_invalid_embed_dim PASSED [ 93%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_pool_operations PASSED [ 95%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_fp8_unsupported_architecture PASSED [ 96%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_backend_kernel_registry_integration PASSED [ 98%]
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_memory_allocation_safety_margin PASSED [100%]

=============================== warnings summary ===============================
kernel_pytorch/attention/distributed/ring_attention.py:41
  /home/shahrahman/kernel_pytorch/attention/distributed/ring_attention.py:41: UserWarning: Hardware Abstraction Layer not available - using basic device coordination
    warnings.warn("Hardware Abstraction Layer not available - using basic device coordination")

kernel_pytorch/attention/distributed/context_parallel.py:41
  /home/shahrahman/kernel_pytorch/attention/distributed/context_parallel.py:41: UserWarning: Hardware Abstraction Layer not available - using basic device coordination
    warnings.warn("Hardware Abstraction Layer not available - using basic device coordination")

kernel_pytorch/precision/fp8_training_engine.py:34
  /home/shahrahman/kernel_pytorch/precision/fp8_training_engine.py:34: UserWarning: Transformer Engine not available - FP8 training will use fallback implementations
    warnings.warn("Transformer Engine not available - FP8 training will use fallback implementations")

kernel_pytorch/distributed_scale/__init__.py:28
  /home/shahrahman/kernel_pytorch/distributed_scale/__init__.py:28: FutureWarning: communication_optimization.py has been refactored into multiple focused modules. Consider importing from the specific modules directly: communication_primitives, network_optimization, communication_profiling
    from .communication_optimization import (

kernel_pytorch/distributed_scale/__init__.py:35
  /home/shahrahman/kernel_pytorch/distributed_scale/__init__.py:35: FutureWarning: hardware_adaptation.py has been refactored into multiple focused modules. Consider importing from the specific modules directly: hardware_discovery, thermal_power_management, fault_tolerance, hardware_adapter
    from .hardware_adaptation import (

kernel_pytorch/distributed_scale/__init__.py:42
  /home/shahrahman/kernel_pytorch/distributed_scale/__init__.py:42: FutureWarning: orchestration.py has been refactored into multiple focused modules. Consider importing from the specific modules directly: job_management, cluster_management, scaling_fault_tolerance
    from .orchestration import (

kernel_pytorch/hardware/__init__.py:28
  /home/shahrahman/kernel_pytorch/hardware/__init__.py:28: UserWarning: Hardware abstraction import failed: No module named 'kernel_pytorch.hardware.distributed_scale'
    warnings.warn(f"Hardware abstraction import failed: {e}")

kernel_pytorch/precision/fp8_optimizations.py:32
  /home/shahrahman/kernel_pytorch/precision/fp8_optimizations.py:32: UserWarning: Transformer Engine not available - using fallback FP8 implementations
    warnings.warn("Transformer Engine not available - using fallback FP8 implementations")

tests/test_nvidia_backend.py::TestNVIDIABackend::test_backend_creation_no_cuda
tests/test_nvidia_backend.py::TestNVIDIABackend::test_prepare_model_no_cuda
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_cuda_not_available_graceful_fallback
  /home/shahrahman/kernel_pytorch/backends/nvidia/nvidia_backend.py:55: UserWarning: CUDA not available. Using CPU fallback.
    warnings.warn("CUDA not available. Using CPU fallback.")

tests/test_nvidia_backend.py::TestNVIDIABackend::test_prepare_model_no_cuda
tests/test_nvidia_backend.py::TestNVIDIAErrorPaths::test_cuda_not_available_graceful_fallback
  /home/shahrahman/kernel_pytorch/backends/nvidia/nvidia_backend.py:137: UserWarning: CUDA not available, returning model unchanged
    warnings.warn("CUDA not available, returning model unchanged")

tests/test_nvidia_backend.py: 23 warnings
  /home/shahrahman/kernel_pytorch/core/kernel_registry.py:156: UserWarning: Overwriting existing kernel: attention:flash_attention_v3:v3.0. Previous backend: cuda, New backend: cuda
    warnings.warn(

tests/test_nvidia_backend.py: 23 warnings
  /home/shahrahman/kernel_pytorch/core/kernel_registry.py:156: UserWarning: Overwriting existing kernel: fusion:fused_linear_gelu:v1.0. Previous backend: cuda, New backend: cuda
    warnings.warn(

tests/test_nvidia_backend.py: 23 warnings
  /home/shahrahman/kernel_pytorch/core/kernel_registry.py:156: UserWarning: Overwriting existing kernel: fusion:fused_linear_silu:v1.0. Previous backend: cuda, New backend: cuda
    warnings.warn(

tests/test_nvidia_backend.py::TestNVIDIABackend::test_optimize_for_tensor_cores
  /home/shahrahman/kernel_pytorch/backends/nvidia/nvidia_backend.py:177: UserWarning: Linear layer  dimensions (10x10) not optimal for Tensor Cores. Consider padding to multiples of 16.
    warnings.warn(

tests/test_nvidia_backend.py::TestCUDAUtilities::test_cuda_device_manager_no_cuda
  /home/shahrahman/kernel_pytorch/backends/nvidia/cuda_utilities.py:47: UserWarning: CUDA not available
    warnings.warn("CUDA not available")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 66 passed, 84 warnings in 7.27s ========================
